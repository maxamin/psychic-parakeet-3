from django.test import TestCase
from vulnman.core.test import VulnmanTestCaseMixin
from apps.responsible_disc import models


class VulnerabilityModelTestCase(TestCase, VulnmanTestCaseMixin):
    def setUp(self):
        self.init_mixin()

    def test_internal_id_creation(self):
        vulnerability1 = self.create_instance(models.Vulnerability)
        _vulnerability2 = self.create_instance(models.Vulnerability)
        vulnerability3 = self.create_instance(models.Vulnerability)
        self.assertEqual(models.Vulnerability.objects.order_by("internal_id").first(), vulnerability1)
        self.assertEqual(models.Vulnerability.objects.order_by("internal_id").last(), vulnerability3)
