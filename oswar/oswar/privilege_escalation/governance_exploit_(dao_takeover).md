# 3. Governance exploit (DAO takeover)

Category: Logic
Tags: Privilege Escalation

### What is a "Governance Exploit"?

In the case of DAOs, a governance exploit can occur when a hacker gains control of a governance contract or a malicious proposal is voted into effect. This can allow the hacker to gain administrative control over the DAO, allowing them to manipulate or steal assets held by the organization or implement overrides.

A DAO, or Decentralized Autonomous Organization, is a type of organization that operates through smart contracts on a blockchain. A DAO can be taken over when an attacker gains control of a sufficient number of voting rights/tokens or other governance exploit methods to influence the decision-making process of the organization. This essentially depends on the rules embedded into the governance structure itself. 

### Example:

In a DAO takeover attack, the attacker seeks to gain control of the organization's governance process by either stealing tokens, performing flash loans, or gaining access to the private keys of a significant number of members. Once the attacker gains control, they can propose and vote on malicious proposals that could grant them additional privileges or access to the organization's assets. Flash loans, in this case, are the most popular method of gaining a sufficient amount of tokens to override a proposal.

A real-world example is **Beanstalk DAO**, which was exploited in 2022.

Beanstalk is a DeFi network with its stablecoin $BEAN at the center of it. In April 2022, a malicious governance attack using a flash loan resulted in the theft of $182 million. In this case, PeckShield was the first to discover that the attacker used Beanstalk's majority rules governance system to steal the $182 million.

The attacker seized majority control of the protocol's governance with a flash loan of $1 billion from Aave, Uniswap, and SushiSwap. They gained enough voting power (majority rules) by swapping the funds and depositing them in the Beanstalk protocol liquidity pools, making it possible to call the emergencyCommit function and trigger an emergency governance execution. The attack leveraged the lack of delay between voting and execution to pass a malicious proposal that transferred deposited funds to the attacker's address. With these steps, the attacker made $80 million in profits.

### Mitigation

The purpose of a DAO is to create decentralized governance practices and rules, and even though it is a noble intent, it can be exploited by malicious parties. Essentially, a DAO wants to enable the majority to implement changes in the future direction of a given protocol. However, this presents numerous vulnerabilities because one person can exploit and cheat themselves to power, even though they follow the rules of the DAO itself.

To prevent a DAO takeover, it is essential to ensure that the logic of the governance structure is set up correctly and implement other robust measures. Since the whole idea is to keep the organization decentralized, mitigation strategies like limiting access to trusted individuals are not an option.

In these scenarios, each DAO is architected differently, which presents new vulnerabilities. Some have added mechanisms, limits, or rules that may present a point of manipulation. It is crucial to regularly review and audit the government contracts of the organization to identify and mitigate potential vulnerabilities. In case of an attack, it is essential to have a response plan in place to quickly mitigate the damage and restore control over the organization.

Real-time monitoring of the DAO smart contracts is also essential for detecting malicious activities.