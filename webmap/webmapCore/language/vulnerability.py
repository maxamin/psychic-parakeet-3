#!/usr/bin/env python

class GenericObservation(object):
    #Constants
    MSG_EVIL_URL = ("  Evil url: {0}")
    MSG_PARAM_INJECT = ("{0} in {1} via injection in the parameter {2}")
    MSG_FROM = ("  coming from {0}")
    MSG_QS_INJECT = ("{0} in {1} via injection in the query string")
    MSG_PATH_INJECT = ("{0} in {1} via injection in the resource path")
    MSG_EVIL_PARAM = ("Involved parameter: {0}")
    MSG_EVIL_REQUEST = ("Evil request:")

    HIGH_LEVEL = "1"
    MEDIUM_LEVEL = "2"
    LOW_LEVEL = "3"

    def __init__(self):
        self.name = ""
        self.description = ""
        self.solution = ""
        self.references = {}

    def getName(self):
        return self.name

    def getDescription(self):
        return self.description

    def getSolution(self):
        return self.solution

    def getReferences(self):
        return self.references

    def setName(self, name):
        self.name = name

    def setDescription(self, description):
        self.description = description

    def setSolution(self, solution):
        self.solution = solution

    def setReferences(self, references):
        self.references = references


class Notice(GenericObservation):
    # Constants
    ERROR_404 = ("File not found message")


class Vulnerability(Notice):
    #Constants
    SQL_INJECTION = ("SQL Injection")
    BLIND_SQL_INJECTION = ("Blind SQL Injection")
    FILE_HANDLING = ("File Handling")
    XSS = ("Cross Site Scripting")
    CRLF = ("CRLF Injection")
    EXEC = ("Commands execution")
    HTACCESS = ("Htaccess Bypass")
    BACKUP = ("Backup file")
    NIKTO = ("Potentially dangerous file")


class Anomaly(Notice):
    # Constants
    ERROR_500 = ("Internal Server Error")
    RES_CONSUMPTION = ("Resource consumption")

    MSG_500 = ("Received a HTTP 500 error in {0}")
    MSG_TIMEOUT = ("Timeout occurred in {0}")

    MSG_QS_TIMEOUT = ("The request timed out while attempting to inject a payload in the query string")
    MSG_PATH_TIMEOUT = ("The request timed out while attempting to inject a payload in the resource path")
    MSG_PARAM_TIMEOUT = ("The request timed out while attempting to inject a payload in the parameter {0}")

    MSG_QS_500 = ("The server responded with a 500 HTTP error code "
                   "while attempting to inject a payload in the query string")
    MSG_PATH_500 = ("The server responded with a 500 HTTP error code "
                     "while attempting to inject a payload in the resource path")
    MSG_PARAM_500 = ("The server responded with a 500 HTTP error code "
                      "while attempting to inject a payload in the parameter {0}")