#!/usr/bin/env python3

"""Exploit Server"""

from time import sleep
from flask import Flask, render_template, request
from selenium import webdriver
from selenium.webdriver.common.by import By

app = Flask(__name__)

options = webdriver.ChromeOptions()
options.add_argument("--headless")
options.add_argument("--no-sandbox")
options.add_argument("--disable-dev-shm-usage")
options.add_argument('--ignore-certificate-errors')
options.add_argument('--disable-infobars')
options.add_argument('--disable-background-networking')
options.add_argument('--disable-default-apps')
options.add_argument('--disable-extensions')
options.add_argument('--disable-gpu')
options.add_argument('--disable-sync')
options.add_argument('--disable-translate')
options.add_argument('--hide-scrollbars')
options.add_argument('--metrics-recording-only')
options.add_argument('--no-first-run')
options.add_argument('--safebrowsing-disable-auto-update')
options.add_argument('--media-cache-size=1')
options.add_argument('--disk-cache-size=1')


@app.route("/", methods=["GET", "POST"])
def index():
    """Main page"""
    if request.method == "POST":
        if request.form.get("url") and request.form.get("url").startswith("http"):
            driver = webdriver.Chrome(options=options)
            driver.get("http://whp-socially/login")
            driver.find_element(By.ID, "username").send_keys("ares")
            driver.find_element(By.ID, "password").send_keys("7Z73j4EjwEhO6l9P")
            driver.find_element(By.ID, "login").click()
            sleep(3)
            driver.get(request.form["url"])
            driver.close()
    return render_template("index.html")


if __name__ == "__main__":
    app.run(host="0.0.0.0", port=80)
