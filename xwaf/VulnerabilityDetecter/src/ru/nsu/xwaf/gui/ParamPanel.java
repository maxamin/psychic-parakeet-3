package ru.nsu.xwaf.gui;

import ru.nsu.xwaf.exceptions.FieldNotFilledException;

import javax.swing.*;
import java.awt.*;

/**
 * Panel which contains transmitted parameters.
 * @author Alexander Ilin
 */
public class ParamPanel {

    private MainFrame parentFrame;
    private JPanel panel = new JPanel();
    {
        panel.setLayout(new BoxLayout(panel, BoxLayout.PAGE_AXIS));
    }

    public ParamPanel(MainFrame parentFrame) {
        this.parentFrame = parentFrame;
    }

    public JComponent getPanel() {
        return panel;
    }

    public void createParam() {
        ParamLine line = new ParamLine(this);
        panel.add(line);
    }

    public String getParams() throws FieldNotFilledException {
        StringBuilder query = new StringBuilder();
        Component[] lines = panel.getComponents();
        for (Component comp : lines) {
            ParamLine line = (ParamLine) comp;
            if (query.length() > 0) {
                query.append('&');
            }
            else {
                query.append('?');
            }
            query.append(line.getText()).append("=");
            switch (line.getType()) {
            case STRING:
                query.append('a');
                break;
            case INTEGER:
                query.append('1');
                break;
            }
        }
        return query.toString();
    }

    public void deleteParam(ParamLine param) {
        panel.remove(param);
        parentFrame.pack();
    }
}
