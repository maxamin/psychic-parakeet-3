{
"bugId": "CVE-2015-5262",
"bugIdAlt": null,
"maturity": "READY",
"origin": "PUBLIC",
"description": "http/conn/ssl/SSLConnectionSocketFactory.java in Apache HttpComponents HttpClient before 4.3.6 ignores the http.socket.timeout configuration setting during an SSL handshake, which allows remote attackers to cause a denial of service (HTTPS call hang) via unspecified vectors.",
"descriptionAlt": null,
"cvssScore": 4.3,
"cvssVersion": "2.0",
"cvssVector": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
"reference": [],
"constructChanges": [
{
"repo": "http://svn.apache.org/repos/asf/httpcomponents/httpclient",
"commit": "1576361",
"repoPath": "/httpcomponents/httpclient/branches/4.3.x/httpclient/src/main/java-deprecated/org/apache/http/conn/ssl/SSLSocketFactory.java",
"constructId": {
"lang": "JAVA",
"type": "PACK",
"qname": "org.apache.http.conn.ssl"
},
"committedAt": "2014-03-11T14:16:10.506+0000",
"constructChangeType": "MOD"
},
{
"repo": "http://svn.apache.org/repos/asf/httpcomponents/httpclient",
"commit": "1576361",
"repoPath": "/httpcomponents/httpclient/branches/4.3.x/httpclient/src/main/java-deprecated/org/apache/http/conn/ssl/SSLSocketFactory.java",
"constructId": {
"lang": "JAVA",
"type": "CLAS",
"qname": "org.apache.http.conn.ssl.SSLSocketFactory"
},
"committedAt": "2014-03-11T14:16:10.506+0000",
"constructChangeType": "MOD"
},
{
"repo": "http://svn.apache.org/repos/asf/httpcomponents/httpclient",
"commit": "1576361",
"repoPath": "/httpcomponents/httpclient/branches/4.3.x/httpclient/src/main/java-deprecated/org/apache/http/conn/ssl/SSLSocketFactory.java",
"constructId": {
"lang": "JAVA",
"type": "METH",
"qname": "org.apache.http.conn.ssl.SSLSocketFactory.connectSocket(Socket,InetSocketAddress,InetSocketAddress,HttpParams)"
},
"committedAt": "2014-03-11T14:16:10.506+0000",
"constructChangeType": "MOD",
"buggyBody": "{\"ast\":[{\"Value\":\"connectSocket\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"19\",\"End\":\"872\"}},\"EntityType\":\"METHOD\",\"C\":[{\"Value\":\"Args.notNull(remoteAddress, \\\"Remote address\\\");\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"293\",\"End\":\"338\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"Args.notNull(params, \\\"HTTP parameters\\\");\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"349\",\"End\":\"388\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"final HttpHost host;\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"405\",\"End\":\"418\"}},\"EntityType\":\"VARIABLE_DECLARATION_STATEMENT\"},{\"Value\":\"(remoteAddress instanceof HttpInetSocketAddress)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"429\",\"End\":\"682\"}},\"EntityType\":\"IF_STATEMENT\",\"C\":[{\"Value\":\"(remoteAddress instanceof HttpInetSocketAddress)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"481\",\"End\":\"567\"}},\"EntityType\":\"THEN_STATEMENT\",\"C\":[{\"Value\":\"host = ((HttpInetSocketAddress) remoteAddress).getHttpHost();\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"496\",\"End\":\"556\"}},\"EntityType\":\"ASSIGNMENT\"}]},{\"Value\":\"(remoteAddress instanceof HttpInetSocketAddress)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"574\",\"End\":\"682\"}},\"EntityType\":\"ELSE_STATEMENT\",\"C\":[{\"Value\":\"host = new HttpHost(remoteAddress.getHostName(), remoteAddress.getPort(), \\\"https\\\");\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"589\",\"End\":\"671\"}},\"EntityType\":\"ASSIGNMENT\"}]}]},{\"Value\":\"final int connectTimeout = HttpConnectionParams.getConnectionTimeout(params);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"699\",\"End\":\"769\"}},\"EntityType\":\"VARIABLE_DECLARATION_STATEMENT\"},{\"Value\":\"connectSocket(connectTimeout, socket, host, remoteAddress, localAddress, null);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"780\",\"End\":\"865\"}},\"EntityType\":\"RETURN_STATEMENT\"}]}]}",
"fixedBody": "{\"ast\":[{\"Value\":\"connectSocket\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"19\",\"End\":\"995\"}},\"EntityType\":\"METHOD\",\"C\":[{\"Value\":\"Args.notNull(remoteAddress, \\\"Remote address\\\");\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"293\",\"End\":\"338\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"Args.notNull(params, \\\"HTTP parameters\\\");\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"349\",\"End\":\"388\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"final HttpHost host;\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"405\",\"End\":\"418\"}},\"EntityType\":\"VARIABLE_DECLARATION_STATEMENT\"},{\"Value\":\"(remoteAddress instanceof HttpInetSocketAddress)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"429\",\"End\":\"682\"}},\"EntityType\":\"IF_STATEMENT\",\"C\":[{\"Value\":\"(remoteAddress instanceof HttpInetSocketAddress)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"481\",\"End\":\"567\"}},\"EntityType\":\"THEN_STATEMENT\",\"C\":[{\"Value\":\"host = ((HttpInetSocketAddress) remoteAddress).getHttpHost();\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"496\",\"End\":\"556\"}},\"EntityType\":\"ASSIGNMENT\"}]},{\"Value\":\"(remoteAddress instanceof HttpInetSocketAddress)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"574\",\"End\":\"682\"}},\"EntityType\":\"ELSE_STATEMENT\",\"C\":[{\"Value\":\"host = new HttpHost(remoteAddress.getHostName(), remoteAddress.getPort(), \\\"https\\\");\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"589\",\"End\":\"671\"}},\"EntityType\":\"ASSIGNMENT\"}]}]},{\"Value\":\"final int socketTimeout = HttpConnectionParams.getSoTimeout(params);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"699\",\"End\":\"760\"}},\"EntityType\":\"VARIABLE_DECLARATION_STATEMENT\"},{\"Value\":\"final int connectTimeout = HttpConnectionParams.getConnectionTimeout(params);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"777\",\"End\":\"847\"}},\"EntityType\":\"VARIABLE_DECLARATION_STATEMENT\"},{\"Value\":\"socket.setSoTimeout(socketTimeout);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"858\",\"End\":\"892\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"connectSocket(connectTimeout, socket, host, remoteAddress, localAddress, null);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"903\",\"End\":\"988\"}},\"EntityType\":\"RETURN_STATEMENT\"}]}]}",
"bodyChange": "{\"StructureEntity\":{\"UniqueName\":\"connectSocket\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"changes\":[{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"final int socketTimeout = HttpConnectionParams.getSoTimeout(params);\",\"EntityType\":\"VARIABLE_DECLARATION_STATEMENT\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"699\",\"End\":\"760\"}},\"ParentEntity\":{\"UniqueName\":\"connectSocket\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"872\"}}},{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"socket.setSoTimeout(socketTimeout);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"858\",\"End\":\"892\"}},\"ParentEntity\":{\"UniqueName\":\"connectSocket\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"872\"}}}]}}"
},
{
"repo": "http://svn.apache.org/repos/asf/httpcomponents/httpclient",
"commit": "1576362",
"repoPath": "/httpcomponents/httpclient/trunk/httpclient/src/main/java-deprecated/org/apache/http/conn/ssl/SSLSocketFactory.java",
"constructId": {
"lang": "JAVA",
"type": "PACK",
"qname": "org.apache.http.conn.ssl"
},
"committedAt": "2014-03-11T14:16:43.642+0000",
"constructChangeType": "MOD"
},
{
"repo": "http://svn.apache.org/repos/asf/httpcomponents/httpclient",
"commit": "1576362",
"repoPath": "/httpcomponents/httpclient/trunk/httpclient/src/main/java-deprecated/org/apache/http/conn/ssl/SSLSocketFactory.java",
"constructId": {
"lang": "JAVA",
"type": "CLAS",
"qname": "org.apache.http.conn.ssl.SSLSocketFactory"
},
"committedAt": "2014-03-11T14:16:43.642+0000",
"constructChangeType": "MOD"
},
{
"repo": "http://svn.apache.org/repos/asf/httpcomponents/httpclient",
"commit": "1576362",
"repoPath": "/httpcomponents/httpclient/trunk/httpclient/src/main/java-deprecated/org/apache/http/conn/ssl/SSLSocketFactory.java",
"constructId": {
"lang": "JAVA",
"type": "METH",
"qname": "org.apache.http.conn.ssl.SSLSocketFactory.connectSocket(Socket,InetSocketAddress,InetSocketAddress,HttpParams)"
},
"committedAt": "2014-03-11T14:16:43.642+0000",
"constructChangeType": "MOD",
"buggyBody": "{\"ast\":[{\"Value\":\"connectSocket\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"19\",\"End\":\"872\"}},\"EntityType\":\"METHOD\",\"C\":[{\"Value\":\"Args.notNull(remoteAddress, \\\"Remote address\\\");\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"293\",\"End\":\"338\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"Args.notNull(params, \\\"HTTP parameters\\\");\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"349\",\"End\":\"388\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"final HttpHost host;\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"405\",\"End\":\"418\"}},\"EntityType\":\"VARIABLE_DECLARATION_STATEMENT\"},{\"Value\":\"(remoteAddress instanceof HttpInetSocketAddress)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"429\",\"End\":\"682\"}},\"EntityType\":\"IF_STATEMENT\",\"C\":[{\"Value\":\"(remoteAddress instanceof HttpInetSocketAddress)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"481\",\"End\":\"567\"}},\"EntityType\":\"THEN_STATEMENT\",\"C\":[{\"Value\":\"host = ((HttpInetSocketAddress) remoteAddress).getHttpHost();\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"496\",\"End\":\"556\"}},\"EntityType\":\"ASSIGNMENT\"}]},{\"Value\":\"(remoteAddress instanceof HttpInetSocketAddress)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"574\",\"End\":\"682\"}},\"EntityType\":\"ELSE_STATEMENT\",\"C\":[{\"Value\":\"host = new HttpHost(remoteAddress.getHostName(), remoteAddress.getPort(), \\\"https\\\");\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"589\",\"End\":\"671\"}},\"EntityType\":\"ASSIGNMENT\"}]}]},{\"Value\":\"final int connectTimeout = HttpConnectionParams.getConnectionTimeout(params);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"699\",\"End\":\"769\"}},\"EntityType\":\"VARIABLE_DECLARATION_STATEMENT\"},{\"Value\":\"connectSocket(connectTimeout, socket, host, remoteAddress, localAddress, null);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"780\",\"End\":\"865\"}},\"EntityType\":\"RETURN_STATEMENT\"}]}]}",
"fixedBody": "{\"ast\":[{\"Value\":\"connectSocket\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"19\",\"End\":\"995\"}},\"EntityType\":\"METHOD\",\"C\":[{\"Value\":\"Args.notNull(remoteAddress, \\\"Remote address\\\");\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"293\",\"End\":\"338\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"Args.notNull(params, \\\"HTTP parameters\\\");\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"349\",\"End\":\"388\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"final HttpHost host;\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"405\",\"End\":\"418\"}},\"EntityType\":\"VARIABLE_DECLARATION_STATEMENT\"},{\"Value\":\"(remoteAddress instanceof HttpInetSocketAddress)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"429\",\"End\":\"682\"}},\"EntityType\":\"IF_STATEMENT\",\"C\":[{\"Value\":\"(remoteAddress instanceof HttpInetSocketAddress)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"481\",\"End\":\"567\"}},\"EntityType\":\"THEN_STATEMENT\",\"C\":[{\"Value\":\"host = ((HttpInetSocketAddress) remoteAddress).getHttpHost();\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"496\",\"End\":\"556\"}},\"EntityType\":\"ASSIGNMENT\"}]},{\"Value\":\"(remoteAddress instanceof HttpInetSocketAddress)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"574\",\"End\":\"682\"}},\"EntityType\":\"ELSE_STATEMENT\",\"C\":[{\"Value\":\"host = new HttpHost(remoteAddress.getHostName(), remoteAddress.getPort(), \\\"https\\\");\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"589\",\"End\":\"671\"}},\"EntityType\":\"ASSIGNMENT\"}]}]},{\"Value\":\"final int socketTimeout = HttpConnectionParams.getSoTimeout(params);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"699\",\"End\":\"760\"}},\"EntityType\":\"VARIABLE_DECLARATION_STATEMENT\"},{\"Value\":\"final int connectTimeout = HttpConnectionParams.getConnectionTimeout(params);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"777\",\"End\":\"847\"}},\"EntityType\":\"VARIABLE_DECLARATION_STATEMENT\"},{\"Value\":\"socket.setSoTimeout(socketTimeout);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"858\",\"End\":\"892\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"connectSocket(connectTimeout, socket, host, remoteAddress, localAddress, null);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"903\",\"End\":\"988\"}},\"EntityType\":\"RETURN_STATEMENT\"}]}]}",
"bodyChange": "{\"StructureEntity\":{\"UniqueName\":\"connectSocket\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"changes\":[{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"final int socketTimeout = HttpConnectionParams.getSoTimeout(params);\",\"EntityType\":\"VARIABLE_DECLARATION_STATEMENT\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"699\",\"End\":\"760\"}},\"ParentEntity\":{\"UniqueName\":\"connectSocket\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"872\"}}},{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"socket.setSoTimeout(socketTimeout);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"858\",\"End\":\"892\"}},\"ParentEntity\":{\"UniqueName\":\"connectSocket\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"872\"}}}]}}"
},
{
"repo": "http://svn.apache.org/repos/asf/httpcomponents/httpclient",
"commit": "1626784",
"repoPath": "/httpcomponents/httpclient/branches/4.3.x/httpclient/src/main/java/org/apache/http/conn/ssl/SSLConnectionSocketFactory.java",
"constructId": {
"lang": "JAVA",
"type": "PACK",
"qname": "org.apache.http.conn.ssl"
},
"committedAt": "2014-09-22T14:13:34.961+0000",
"constructChangeType": "MOD"
},
{
"repo": "http://svn.apache.org/repos/asf/httpcomponents/httpclient",
"commit": "1626784",
"repoPath": "/httpcomponents/httpclient/branches/4.3.x/httpclient/src/main/java/org/apache/http/conn/ssl/SSLConnectionSocketFactory.java",
"constructId": {
"lang": "JAVA",
"type": "CLAS",
"qname": "org.apache.http.conn.ssl.SSLConnectionSocketFactory"
},
"committedAt": "2014-09-22T14:13:34.961+0000",
"constructChangeType": "MOD"
},
{
"repo": "http://svn.apache.org/repos/asf/httpcomponents/httpclient",
"commit": "1626784",
"repoPath": "/httpcomponents/httpclient/branches/4.3.x/httpclient/src/main/java/org/apache/http/conn/ssl/SSLConnectionSocketFactory.java",
"constructId": {
"lang": "JAVA",
"type": "METH",
"qname": "org.apache.http.conn.ssl.SSLConnectionSocketFactory.connectSocket(int,Socket,HttpHost,InetSocketAddress,InetSocketAddress,HttpContext)"
},
"committedAt": "2014-09-22T14:13:34.961+0000",
"constructChangeType": "MOD",
"buggyBody": "{\"ast\":[{\"Value\":\"connectSocket\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"19\",\"End\":\"1239\"}},\"EntityType\":\"METHOD\",\"C\":[{\"Value\":\"Args.notNull(host, \\\"HTTP host\\\");\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"321\",\"End\":\"352\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"Args.notNull(remoteAddress, \\\"Remote address\\\");\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"363\",\"End\":\"408\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"final Socket sock = ((socket != null) ? socket : createSocket(context));\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"425\",\"End\":\"486\"}},\"EntityType\":\"VARIABLE_DECLARATION_STATEMENT\"},{\"Value\":\"(localAddress != null)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"497\",\"End\":\"572\"}},\"EntityType\":\"IF_STATEMENT\",\"C\":[{\"Value\":\"(localAddress != null)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"523\",\"End\":\"572\"}},\"EntityType\":\"THEN_STATEMENT\",\"C\":[{\"Value\":\"sock.bind(localAddress);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"538\",\"End\":\"561\"}},\"EntityType\":\"METHOD_INVOCATION\"}]}]},{\"Value\":\"\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"583\",\"End\":\"836\"}},\"EntityType\":\"TRY_STATEMENT\",\"C\":[{\"Value\":\"\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"587\",\"End\":\"656\"}},\"EntityType\":\"BODY\",\"C\":[{\"Value\":\"sock.connect(remoteAddress, connectTimeout);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"602\",\"End\":\"645\"}},\"EntityType\":\"METHOD_INVOCATION\"}]},{\"Value\":\"\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"657\",\"End\":\"836\"}},\"EntityType\":\"CATCH_CLAUSES\",\"C\":[{\"Value\":\"IOException\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"658\",\"End\":\"836\"}},\"EntityType\":\"CATCH_CLAUSE\",\"C\":[{\"Value\":\"\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"702\",\"End\":\"802\"}},\"EntityType\":\"TRY_STATEMENT\",\"C\":[{\"Value\":\"\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"706\",\"End\":\"752\"}},\"EntityType\":\"BODY\",\"C\":[{\"Value\":\"sock.close();\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"725\",\"End\":\"737\"}},\"EntityType\":\"METHOD_INVOCATION\"}]},{\"Value\":\"\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"753\",\"End\":\"802\"}},\"EntityType\":\"CATCH_CLAUSES\",\"C\":[{\"Value\":\"IOException\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"754\",\"End\":\"802\"}},\"EntityType\":\"CATCH_CLAUSE\"}]}]},{\"Value\":\"ex;\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"817\",\"End\":\"825\"}},\"EntityType\":\"THROW_STATEMENT\"}]}]}]},{\"Value\":\"(sock instanceof SSLSocket)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"891\",\"End\":\"1232\"}},\"EntityType\":\"IF_STATEMENT\",\"C\":[{\"Value\":\"(sock instanceof SSLSocket)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"922\",\"End\":\"1113\"}},\"EntityType\":\"THEN_STATEMENT\",\"C\":[{\"Value\":\"final SSLSocket sslsock = (SSLSocket) sock;\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"943\",\"End\":\"979\"}},\"EntityType\":\"VARIABLE_DECLARATION_STATEMENT\"},{\"Value\":\"sslsock.startHandshake();\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"994\",\"End\":\"1018\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"verifyHostname(sslsock, host.getHostName());\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"1033\",\"End\":\"1076\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"sock;\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"1091\",\"End\":\"1102\"}},\"EntityType\":\"RETURN_STATEMENT\"}]},{\"Value\":\"(sock instanceof SSLSocket)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"1120\",\"End\":\"1232\"}},\"EntityType\":\"ELSE_STATEMENT\",\"C\":[{\"Value\":\"createLayeredSocket(sock, host.getHostName(), remoteAddress.getPort(), context);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"1135\",\"End\":\"1221\"}},\"EntityType\":\"RETURN_STATEMENT\"}]}]}]}]}",
"fixedBody": "{\"ast\":[{\"Value\":\"connectSocket\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"19\",\"End\":\"1373\"}},\"EntityType\":\"METHOD\",\"C\":[{\"Value\":\"Args.notNull(host, \\\"HTTP host\\\");\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"321\",\"End\":\"352\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"Args.notNull(remoteAddress, \\\"Remote address\\\");\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"363\",\"End\":\"408\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"final Socket sock = ((socket != null) ? socket : createSocket(context));\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"425\",\"End\":\"486\"}},\"EntityType\":\"VARIABLE_DECLARATION_STATEMENT\"},{\"Value\":\"(localAddress != null)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"497\",\"End\":\"572\"}},\"EntityType\":\"IF_STATEMENT\",\"C\":[{\"Value\":\"(localAddress != null)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"523\",\"End\":\"572\"}},\"EntityType\":\"THEN_STATEMENT\",\"C\":[{\"Value\":\"sock.bind(localAddress);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"538\",\"End\":\"561\"}},\"EntityType\":\"METHOD_INVOCATION\"}]}]},{\"Value\":\"\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"583\",\"End\":\"970\"}},\"EntityType\":\"TRY_STATEMENT\",\"C\":[{\"Value\":\"\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"587\",\"End\":\"790\"}},\"EntityType\":\"BODY\",\"C\":[{\"Value\":\"((connectTimeout > 0) && (sock.getSoTimeout() == 0))\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"602\",\"End\":\"721\"}},\"EntityType\":\"IF_STATEMENT\",\"C\":[{\"Value\":\"((connectTimeout > 0) && (sock.getSoTimeout() == 0))\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"654\",\"End\":\"721\"}},\"EntityType\":\"THEN_STATEMENT\",\"C\":[{\"Value\":\"sock.setSoTimeout(connectTimeout);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"673\",\"End\":\"706\"}},\"EntityType\":\"METHOD_INVOCATION\"}]}]},{\"Value\":\"sock.connect(remoteAddress, connectTimeout);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"736\",\"End\":\"779\"}},\"EntityType\":\"METHOD_INVOCATION\"}]},{\"Value\":\"\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"791\",\"End\":\"970\"}},\"EntityType\":\"CATCH_CLAUSES\",\"C\":[{\"Value\":\"IOException\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"792\",\"End\":\"970\"}},\"EntityType\":\"CATCH_CLAUSE\",\"C\":[{\"Value\":\"\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"836\",\"End\":\"936\"}},\"EntityType\":\"TRY_STATEMENT\",\"C\":[{\"Value\":\"\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"840\",\"End\":\"886\"}},\"EntityType\":\"BODY\",\"C\":[{\"Value\":\"sock.close();\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"859\",\"End\":\"871\"}},\"EntityType\":\"METHOD_INVOCATION\"}]},{\"Value\":\"\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"887\",\"End\":\"936\"}},\"EntityType\":\"CATCH_CLAUSES\",\"C\":[{\"Value\":\"IOException\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"888\",\"End\":\"936\"}},\"EntityType\":\"CATCH_CLAUSE\"}]}]},{\"Value\":\"ex;\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"951\",\"End\":\"959\"}},\"EntityType\":\"THROW_STATEMENT\"}]}]}]},{\"Value\":\"(sock instanceof SSLSocket)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"1025\",\"End\":\"1366\"}},\"EntityType\":\"IF_STATEMENT\",\"C\":[{\"Value\":\"(sock instanceof SSLSocket)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"1056\",\"End\":\"1247\"}},\"EntityType\":\"THEN_STATEMENT\",\"C\":[{\"Value\":\"final SSLSocket sslsock = (SSLSocket) sock;\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"1077\",\"End\":\"1113\"}},\"EntityType\":\"VARIABLE_DECLARATION_STATEMENT\"},{\"Value\":\"sslsock.startHandshake();\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"1128\",\"End\":\"1152\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"verifyHostname(sslsock, host.getHostName());\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"1167\",\"End\":\"1210\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"sock;\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"1225\",\"End\":\"1236\"}},\"EntityType\":\"RETURN_STATEMENT\"}]},{\"Value\":\"(sock instanceof SSLSocket)\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"1254\",\"End\":\"1366\"}},\"EntityType\":\"ELSE_STATEMENT\",\"C\":[{\"Value\":\"createLayeredSocket(sock, host.getHostName(), remoteAddress.getPort(), context);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"1269\",\"End\":\"1355\"}},\"EntityType\":\"RETURN_STATEMENT\"}]}]}]}]}",
"bodyChange": "{\"StructureEntity\":{\"UniqueName\":\"connectSocket\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"changes\":[{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"((connectTimeout > 0) && (sock.getSoTimeout() == 0))\",\"EntityType\":\"IF_STATEMENT\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"602\",\"End\":\"721\"}},\"ParentEntity\":{\"UniqueName\":\"\",\"EntityType\":\"BODY\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"587\",\"End\":\"656\"}}},{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"sock.setSoTimeout(connectTimeout);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"673\",\"End\":\"706\"}},\"ParentEntity\":{\"UniqueName\":\"((connectTimeout > 0) && (sock.getSoTimeout() == 0))\",\"EntityType\":\"THEN_STATEMENT\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"654\",\"End\":\"721\"}}}]}}"
}
]
}